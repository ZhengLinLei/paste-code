class Terminal{#e;#t=[];help='\n        <div>\n            <pre>\n<span class="token comment">-----------------------------</span>\n    <span class="class-name token">Commands:</span>\n        - window [add | remove] [:int]\n            usage:\n                window add 3\n        \n        - terminal [close | open]\n            usage:\n                terminal close\n        \n        - terminal [color | bg] [set | get | reset] [:hex | :rgb | :hsl]    (not implemented)\n            usage:\n                terminal color set #fff\n        \n        - config [set | get | reset]\n            usage:\n                config get\n\n        - font [set | get | reset] [:int]\n            usage:\n                font set +3\n\n        - theme [set | get | reset | list] [:string]\n            usage:\n                theme set dark\n\n        - run [:int (windows: 0-3, default: 0)]\n            usage:\n                run 1\n\n        - execute [:int (windows: 0-3, default: 0)]\n            usage:\n                execute 0\n\n        - cls\n    \n        - exit\n    \n        - help\n    \n    <span class="class-name token">More info:</span>\n        <a href="https://github.com/ZhengLinLei/paste-code">https://github.com/ZhengLinLei/paste-code</a>\n    \n    <span class="class-name token">Issues:</span>\n        <a href="https://github.com/ZhengLinLei/paste-code/issues">https://github.com/ZhengLinLei/paste-code/issues</a>\n    \n    <span class="class-name token">Author:</span>\n        <a href="https://github.com/ZhengLinLei">Zheng Lin Lei</a>\n<span class="token comment">-----------------------------</span>\n            </pre>\n        </div>\n    ';executer={python:"https://pyscript.net/latest/pyscript.js",javascript:"./js/min/executer/executer.min.js",typescript:"https://unpkg.com/typescript@latest/lib/typescriptServices.js",brainfuck:"./js/min/executer/brainfuck.min.js",php:"./js/src/executer/php.js",java:"https://unpkg.com/java-to-javascript@latest/build/java-to-javascript.min.js"};constructor(e){this.#e=e}commands={window:["add","remove"],terminal:["close","open"],cls:0,exit:0,help:0,config:["set","get","reset"],font:["set","get","reset"],theme:["set","get","reset","list"],run:0,execute:0};exec=e=>new Promise((t=>{let n=e.split(" ");this.#t.push(e),Object.keys(this.commands).includes(n[0])&&((0==this.commands[n[0]]||this.commands[n[0]].includes(n[1]))&&t(this.execution[n[0]](n)),t([0,`Path "${n[1]}" not found`])),t([0,`Command "${n[0]}" not found`])}));execution={terminal:e=>(this.#e.terminal.toggleFnc(e[1]),[1,""]),window:e=>{let t=0;if(e.length>2){if(!parseInt(e[2]))return[0,`Invalid argument ${e[2]}`];t=parseInt(e[2])}else t=1;for(let n=0;n<t;n++)"add"==e[1]?this.#e.window.add():this.#e.window.remove();return[1,""]},exit:()=>(this.#e.terminal.toggleFnc("close"),[1,""]),cls:()=>(this.#e.terminal.output.innerHTML="",this.#e.terminal.caret.style.transform="translateX(0px)",this.#e.terminal.config.position=0,[1,""]),help:()=>[1,this.help],config:e=>{let t={},n=[1,'\n                <br>\n                <div>\n                    <span>Reload required <a href="javascript:location.reload()">[yes]</a><a>[no]</a></span>\n                </div>\n                <br>\n                '];switch(e[1]){case"set":t=JSON.parse(e.slice(2).join("")),Object.entries(t).forEach((([e,t])=>{"undefined"!==t&&"null"!==t&&"NaN"!==t||(n=[0,`Invalid value ${t}`]),"default"!=t?localStorage.setItem(e,t):localStorage.removeItem(e)}));break;case"get":t={terminal:localStorage.getItem("terminal")||!1,terminalHeight:localStorage.getItem("terminalHeight")||"default",terminalOptWidth:localStorage.getItem("terminalOptWidth")||"default",fontSize:localStorage.getItem("fontSize")||"default",theme:localStorage.getItem("theme")||"default"},n=[1,`\n                        <br>\n                        <div>\n                            <pre><code class="language-json">${Prism.highlight(JSON.stringify(t,null,4).trim(),Prism.languages.json,"json")}</code></pre>\n                        </div>\n                        <div>\n                            <span>config set ${JSON.stringify(t)}</span>\n                        </div>\n                        <br>\n                        `];break;case"reset":localStorage.clear()}return n},font:e=>{let t=[1,""],n=document.documentElement||document.querySelector(":root"),a=parseInt(window.getComputedStyle(n,null).getPropertyValue("font-size").replace("px",""));switch(e[1]){case"set":if(e[2].match(/[-+]/)){a=a+parseInt(e[2])}else a=parseInt(e[2]);break;case"get":t=[1,`<br><div><span>Font size: <span class="token comment">${a}px</span></span></div><br>`];break;case"reset":a=12}return"get"!=e[1]&&n.style.setProperty("--font-size",`${a}px`),localStorage.setItem("fontSize",a),t},theme:e=>{let t=[1,""];switch(e[1]){case"set":this.#e.theme.list.includes(e[2])?this.#e.theme.set(e[2]):t=[0,`Theme "${e[2]}" not found`];break;case"get":t=[1,`<div><span>Current theme: <span class="token comment">${localStorage.getItem("theme")||this.#e.theme.list[0]}</span></span></div>`];break;case"reset":this.#e.theme.set("light");break;case"list":t=[1,`<div><span>Theme list: <span class="token comment">${this.#e.theme.list.join(", ")}</span></span><p>See <a href="https://github.com/ZhengLinLei/paste-code/blob/main/THEME.md">https://github.com/ZhengLinLei/paste-code/blob/main/THEME.md</a> to customise themes.</div>`]}return t},run:e=>{if(e.length>=2&&"list"==e[1])return[1,`<div><span>Executer supported languages: <span class="token comment">${Object.keys(this.executer).join(", ")}</span></span></div><br>`];let t=e[1]||0,n=this.#e.window.config.windows[t];if(!n)return[0,`Window ${t} not found`];let a=n.value,s=a.split("\n"),i=this.#e.window.getLang(n),r=Object.entries({python:["python","py"],javascript:["javascript","js"],typescript:["typescript","ts"],brainfuck:["brainfuck","bf"],php:["php"],java:["java"]}).find((([e,t])=>t.includes(i)));if(!r)return[0,`Language "${i}" not executable. See <a href="https://github.com/ZhengLinLei/paste-code/blob/main/EXECUTER.md">https://github.com/ZhengLinLei/paste-code/blob/main/EXECUTER.md</a> for more information.`];r=r[0];let o=this.executer[r],c=document.querySelector(`script[src="${o}"]`);c||(c=document.createElement("script"),c.setAttribute("defer","true"),c.src=o,document.body.appendChild(c));let l=`b${Math.random().toString(36).substring(7)}b`;function p(){document.querySelector(`#${l}`).innerHTML=""}function u(e){document.querySelector(`#${l}`).innerHTML+=e}switch(TMP_ID=l,this.#e.terminal.output.innerHTML+=`<div id="${l}">Loading executer...</div>`,a=s.slice(1).join("\n"),r){case"python":function h(e){let t=document.createElement("py-script");t.style.opacity=0,t.innerHTML=`\n                        from js import Out\n\n                        ${a}\n                        `,e.#e.terminal.output.appendChild(t),p()}a=a.replace(/print\(/g,"Out("),"undefined"==typeof pyscript?c.onload=()=>{h(this)}:h(this);break;case"javascript":a=a.replace(/console.log\(/g,"Out("),new JSexecuter(a).run();break;case"typescript":function d(){p();try{let e=window.ts.transpile(a);new JSexecuter(e).run()}catch(e){return u(`<span class="token title important">Error TS</span>: ${e}`),[0,"Error executing"]}}a=a.replace(/console.log\(/g,"Out("),window.ts?d():c.onload=d;break;case"brainfuck":let m=[],g=[];function f(){let e=new Brainfuck(new Infinite);p(),e.code.source(a),e.onOutput((function(e){m.push(String.fromCharCode(e)),g.push(e)})),e.run((()=>{let e="\n                            <style>\n                            td{\n                                text-align: center;\n                                padding-right: 10px;\n                            }\n                            </style>\n                            <table>\n                                <tr>\n                            ";m.forEach((t=>e+=`<td>${t}</td>`)),e+="\n                                </tr>\n                                <tr>\n                            ",g.forEach((t=>e+=`<td><span class="token comment">${t}</span></td>`)),e+="\n                                </tr>\n                            </table>\n                            ",Out(e),Out(m.join(""))}))}"undefined"==typeof Brainfuck?c.onload=f:f();break;case"php":const b=new URLSearchParams(window.location.search).entries();let w=[];for(const k of b)w.push(`"${k[0]}" => "${k[1]}"`);function v(){let e=new PHP(a).vm.OUTPUT_BUFFER;p(),Out(e)}a=a.replace("<?php",""),a=`<?php\n                        $_GET = [${w.join(", ")}];\n                    `+a,"undefined"==typeof PHP?c.onload=v:v();break;case"java":function y(){p();try{let e=window.javaToJavascript(a);e+="\n                            if(typeof Main === 'function'){\n                                Main.main();\n                            }\n                            ",new JSexecuter(e).run()}catch(e){return u(`<span class="token title important">Error Java</span>: ${e}`),[0,"Error executing"]}}a=a.replace(/System.out.println\(/g,"Out("),void 0===window.javaToJavascript?c.onload=y:y()}return[1,""]},execute:e=>{if(e.length>1&&e[1].includes("alert"))return e[1].includes("disable")?localStorage.setItem("disableAlertExec",!0):localStorage.removeItem("disableAlertExec"),[1,'\n                <br>\n                <div>\n                    <span>Alert <span class="token title important">warning</span> updated</span>\n                </div>\n                <div>\n                    <span class="token comment">Disable it with <span class="token operator">execute disable-alert</span>.<br> Or enable it with <span class="token operator">execute enable-alert</span></span>\n                </div>\n                <br>\n                '];{if("undefined"==typeof JSexecuter){let t=document.createElement("script");return t.setAttribute("defer","true"),t.src=this.executer.javascript,document.body.appendChild(t),[0,`Execution failed due: Script loading...; Please execute again <a>${e.join(" ")}</a>`]}let t=e[1]||0,n=this.#e.window.config.windows[t];if(!n)return[0,`Window ${t} not found`];let a=`\n                    function runModule(){\n                        ${n.value}\n\n                        return "Script Loaded";\n                    }\n                `;return new JSexecuter(a).run(),localStorage.getItem("disableAlertExec")?[1,`\n                <span class="comment token">${runModule()}</span>\n                `]:[1,'\n                        <br>\n                        <div>\n                            <span>This action could be dangerous. Are you sure you want to execute it? <a href="javascript:runModule()">[yes]</a><a>[no]</a></span>\n                        </div>\n                        <div>\n                            <span class="token comment">By the way you can disable this alert with <span class="token operator">execute disable-alert</span>.<br> Or enable it with <span class="token operator">execute enable-alert</span></span>\n                        </div>\n                        <br>\n                    ']}}};getHistory(){return this.#t}}