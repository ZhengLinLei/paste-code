window.addEventListener("load",()=>{"true"===localStorage.getItem("dark")&&document.body.classList.add("dark");var lzma=new LZMA("./js/min/lzma_worker.min.js");const ROOT_url=document.location,WINDOW_CONFIG={parent:document.querySelector(".textarea"),max:4,min:1,label:"Window",current:0,windows:[],windows_value:[]},addWindow=()=>{if(WINDOW_CONFIG.current<WINDOW_CONFIG.max){const newWindow=document.createElement("textarea");newWindow.setAttribute("class","textarea-main"),newWindow.setAttribute("spellcheck","false"),WINDOW_CONFIG.parent.appendChild(newWindow),WINDOW_CONFIG.windows.push(newWindow),WINDOW_CONFIG.current++}},closeOffer=()=>document.querySelector("body > footer").classList.remove("text-offer"),__main__=()=>{const invert=document.querySelector(".invert-color");invert.addEventListener("click",()=>{document.body.classList.toggle("dark"),document.body.classList.contains("dark")?localStorage.setItem("dark",!0):localStorage.setItem("dark",!1)}),0==WINDOW_CONFIG.current&&addWindow(),document.querySelector("#add-w").addEventListener("click",addWindow),document.querySelector("#remove-w").addEventListener("click",()=>{WINDOW_CONFIG.current>WINDOW_CONFIG.min&&(WINDOW_CONFIG.parent.removeChild(WINDOW_CONFIG.windows[WINDOW_CONFIG.windows.length-1]),WINDOW_CONFIG.windows.pop(),WINDOW_CONFIG.current--)}),document.querySelectorAll("#generate-url").forEach(btn=>{btn.addEventListener("click",()=>{const btn_type=btn.getAttribute("data-type");WINDOW_CONFIG.windows.forEach((window,index)=>WINDOW_CONFIG.windows_value[index]=window.value),lzma.compress(JSON.stringify(WINDOW_CONFIG.windows_value),1,(compressed,error)=>{if(error)return void alert("Failed to compress data: "+error);let reader=new FileReader;reader.onload=function(){let base64=reader.result.substr(reader.result.indexOf(",")+1),url="https://"+ROOT_url.host+ROOT_url.pathname+"#"+base64;var result="markdown"===btn_type?"[paste]("+url+")":url;navigator.clipboard.writeText(result),document.querySelector(".nav-text-offer input").value=result,document.querySelector("body > footer").classList.add("text-offer")},reader.readAsDataURL(new Blob([new Uint8Array(compressed)]))})})}),document.querySelector("a.cancel-url").addEventListener("click",closeOffer),document.querySelector("a.copy-url").addEventListener("click",()=>{var input;document.querySelector(".nav-text-offer input").select(),document.execCommand("copy"),closeOffer()})};fn=async()=>{let base64=location.hash.substring(1);if(0==base64.length||"undefined"==base64||!fetch)return void __main__();let r=await fetch("data:application/octet-stream;base64,"+base64),blob=await r.blob(),reader=new FileReader;reader.onload=function(){var compressed_data=Array.from(new Uint8Array(reader.result));lzma.decompress(compressed_data,(function(plaintext,error){error&&alert("Failed to decompress data: "+error);try{const arrayData=JSON.parse(plaintext);"object"==typeof arrayData&&arrayData.forEach((el,i)=>{addWindow(),WINDOW_CONFIG.windows[i].value=el})}catch(error){alert("Failed to writing data: "+error)}__main__()}))},reader.readAsArrayBuffer(blob)},fn()});