let setTabSize=t=>{document.querySelectorAll(".textarea div pre code").forEach(e=>{e.style.tabSize=""+(0!=t?t:4),e.style.MozTabSize=""+(0!=t?t:4)}),tabSize=t},tabSize=4,tabRegex=/\t/g;const ThemeArr=["light","dark","funky","twilight","solarized","night","zll"];let TMP_ID=0;function Out(e){document.querySelector("#"+TMP_ID).innerHTML+=e+"<br>"}window.addEventListener("load",()=>{var s=new LZMA("./js/src/lzma_worker.js");const m={url:document.location},p={parent:document.querySelector(".textarea"),max:4,min:1,label:"Window",current:0,focus:0,windows:[],codeWindow:[],windows_value:[],lineActive:[]},h=e=>{var e=e.value.split("\n")[0];return!!e.match(/[\!|\?]/)&&((e=(e=e.split(/[\!|\?]/))[e.length-1].toLowerCase()).includes("--\x3e")?e.replace("--\x3e","").trim():e)},i=e=>{var t=p.windows.indexOf(e),n=p.codeWindow[t],o=e.value.split("\n"),r=h(e);r&&n.setAttribute("class","language-"+r),tabRegex.test(e.value)&&(e.value=e.value.replaceAll(tabRegex," ".repeat(tabSize))),n.innerHTML=e.value.replaceAll(new RegExp("&","g"),"&amp;").replaceAll(new RegExp("<","g"),"&lt;"),Prism.highlightElement(n),document.querySelector(".w-"+t).style.setProperty("--padd",100<=o.length?1e3<=o.length?1e4<=o.length?"55px":"45px":"35px":"25px"),e.parentElement.querySelector(".line-numbers-rows").innerHTML=Array(o.length).fill("<span></span>").join(""),e===document.activeElement&&l(e)},l=(e,t=-1)=>{var n=e.value.substring(0,e.selectionStart).split("\n").length,o=e.parentElement.querySelector(".line-numbers-rows");n+t<o.children.length&&!o.children[n+t].classList.contains("current")&&(a(e),o.children[n+t].classList.add("current"))},a=e=>{e=e.parentElement.querySelector(".line-numbers-rows");Array.from(e.children).forEach(e=>{e.classList.remove("current")})},w=()=>{if(p.current<p.max){const t=document.createElement("div"),n=(t.addEventListener("click",()=>{var e=t.classList[0].replace("w-","");p.focus=e}),document.createElement("pre"));n.setAttribute("aria-hidden","true");var e=document.createElement("code");const o=document.createElement("span"),r=(o.setAttribute("aria-hidden","true"),o.setAttribute("class","line-numbers-rows no-select"),o.innerHTML="<span></span>",document.createElement("textarea"));r.setAttribute("class","textarea-main"),r.setAttribute("spellcheck","false"),r.setAttribute("outline","none"),r.setAttribute("autofill","false"),r.setAttribute("autocorrect","off"),r.setAttribute("autocapitalize","off"),r.setAttribute("autocomplete","off"),r.setAttribute("wrap","off"),r.setAttribute("aria-label","Paste Code"),r.setAttribute("tabindex","0"),r.addEventListener("input",()=>i(r)),r.addEventListener("mouseup",()=>l(r)),("ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints)&&r.addEventListener("touchend",()=>l(r)),r.addEventListener("scroll",()=>{n.scrollTo(r.scrollLeft,r.scrollTop),o.scrollTo(r.scrollLeft,r.scrollTop)}),r.addEventListener("keydown",e=>{var t;"Tab"!=e.key&&9!=e.keyCode&&9!=e.which||(e.preventDefault(),t=r.selectionStart,r.value=r.value.substring(0,t)+" ".repeat(tabSize)+r.value.substring(r.selectionEnd),r.selectionStart=r.selectionEnd=t+tabSize,i(r)),"ArrowUp"!=e.key&&38!=e.keyCode&&38!=e.which||l(r,delay=-2),"ArrowDown"!=e.key&&40!=e.keyCode&&40!=e.which||l(r,delay=0),(e.altKey&&"l"==e.key||e.altKey&&76==e.keyCode||e.altKey&&76==e.which)&&(e.preventDefault(),t=r.value.substring(0,r.selectionStart).lastIndexOf("\n")+1,e=r.value.substring(r.selectionEnd).indexOf("\n")+r.selectionEnd,e+=e==r.value.length-1?1:0,r.setSelectionRange(t,e))}),r.addEventListener("keyup",e=>{"Enter"!=e.key&&13!=e.keyCode&&13!=e.which&&"ArrowUp"!=e.key&&38!=e.keyCode&&38!=e.which&&"ArrowDown"!=e.key&&40!=e.keyCode&&40!=e.which&&"ArrowLeft"!=e.key&&37!=e.keyCode&&37!=e.which&&"ArrowRight"!=e.key&&39!=e.keyCode&&39!=e.which||l(r)}),r.addEventListener("focusout",()=>{a(r)}),n.appendChild(e),t.appendChild(o),t.appendChild(r),t.appendChild(n),p.parent.appendChild(t),p.windows.push(r),p.current++,p.parent.classList.remove("odd"),p.current%2!=0&&p.parent.classList.add("odd"),p.codeWindow.push(e),t.classList.add("w-"+(p.current-1))}},g=()=>{p.current>p.min&&(p.parent.removeChild(p.windows[p.focus].parentElement),p.windows=p.windows.filter((e,t)=>t!=p.focus),p.codeWindow=p.codeWindow.filter((e,t)=>t!=p.focus),p.current--,p.parent.classList.remove("odd"),p.current%2!=0&&p.parent.classList.add("odd"),p.windows.forEach((e,t)=>{e.parentElement.classList.remove(...e.parentElement.classList),e.parentElement.classList.add("w-"+t)}))},v=()=>document.querySelector("body > footer").classList.remove("text-offer");let f;const n=()=>{window.addEventListener("keydown",e=>{((e.metaKey||e.ctrlKey||e.altKey)&&"t"==e.key||(e.metaKey||e.ctrlKey||e.altKey)&&84==e.keyCode||(e.metaKey||e.ctrlKey||e.altKey)&&84==e.which)&&(e.preventDefault(),f())});const e=e=>{ThemeArr.includes(e)||(e=ThemeArr[0]),document.body.classList.remove(...ThemeArr),document.body.classList.add(e),localStorage.setItem("theme",e)};document.querySelector(".invert-color").addEventListener("click",()=>{document.body.classList.contains("dark")?e("light"):e("dark")}),0==p.current&&w(),document.querySelector("#add-w").addEventListener("click",w),document.querySelector("#remove-w").addEventListener("click",g),document.querySelectorAll(".generate-url").forEach(e=>{e.addEventListener("click",()=>{const n=e.getAttribute("data-type");p.windows.forEach((e,t)=>p.windows_value[t]=e.value),s.compress(JSON.stringify(p.windows_value),1,(e,t)=>{if(t)alert("Failed to compress data: "+t);else{let t=new FileReader;t.onload=function(){var e=t.result.substr(t.result.indexOf(",")+1),e="https://"+m.url.host+m.url.pathname+"#"+e,e="markdown"===n?"[paste]("+e+")":e;navigator.clipboard.writeText(e),document.querySelector(".nav-text-offer input").value=e,document.querySelector("body > footer").classList.add("text-offer")},t.readAsDataURL(new Blob([new Uint8Array(e)]))}})})}),document.querySelector("a.cancel-url").addEventListener("click",v),document.querySelector("a.copy-url").addEventListener("click",()=>{document.querySelector(".nav-text-offer input").select(),document.execCommand("copy"),v()}),f=(e="toggle")=>{switch(e){case"open":document.querySelector("#terminal").classList.add("open"),c.focus();break;case"close":document.querySelector("#terminal").classList.remove("open");break;case"toggle":document.querySelector("#terminal").classList.toggle("open"),c.focus()}localStorage.setItem("terminal",!!document.querySelector("#terminal").classList.contains("open"))};const o=()=>{l.historyPosition=0;var e=document.createElement("div");e.classList.add("terminal-input"),e.innerHTML=document.querySelector("#terminal-main-input").innerHTML,i.appendChild(e),e.removeChild(e.querySelector("button")),a.exec(r.innerText).then(e=>{var t;l.position=0,r.innerHTML="",(!e[0]||0<e[1].length)&&((t=document.createElement("div")).classList.add("terminal-output"),t.innerHTML=e[1],i.appendChild(t)),c.scrollTop=c.scrollHeight})},c=document.querySelector("#terminal-main"),r=document.querySelector("#terminal-main-command"),n=document.querySelector("#terminal-caret"),i=document.querySelector("#terminal-main-history"),l={position:0,historyPosition:0},d=(document.querySelector("#open-t").addEventListener("click",()=>f("open")),document.querySelector("#close-t").addEventListener("click",()=>f("close")),c.addEventListener("focus",()=>{c.scrollTop=c.scrollHeight,n.classList.add("blink")}),c.addEventListener("blur",()=>n.classList.remove("blink")),c.addEventListener("keydown",e=>{var t;e.ctrlKey||e.metaKey||e.altKey||(e.preventDefault(),1==e.key.length&&(l.position+=1,r.innerText=r.innerText.slice(0,l.position-1)+e.key+r.innerText.slice(l.position-1))),"ArrowLeft"==e.key&&(l.position-=0<l.position?1:0),"ArrowRight"==e.key&&(l.position+=l.position<r.innerText.length?1:0),"ArrowLeft"!=e.key&&"ArrowRight"!=e.key||(t=n.getBoundingClientRect().width-2*parseFloat(getComputedStyle(n,null).getPropertyValue("border-left-width"))-1e-5,n.style.transform=`translateX(-${(r.innerText.length-l.position)*t}px)`),"ArrowUp"!=e.key&&"ArrowDown"!=e.key||(t=a.getHistory(),l.historyPosition+="ArrowUp"==e.key?l.historyPosition>=t.length?0:1:l.historyPosition<=0?0:-1,t=t[t.length-l.historyPosition],r.innerText=t||"",l.position=r.innerText.length),"v"==e.key&&(e.ctrlKey||e.metaKey)&&navigator.clipboard.readText().then(e=>{r.innerText=r.innerText.slice(0,l.position-1)+e+r.innerText.slice(l.position-1),l.position+=e.length}),"Backspace"!=e.key&&"Delete"!=e.key||(r.innerText=r.innerText.slice(0,l.position-1)+r.innerText.slice(l.position),l.position-=0==l.position?0:1),"Enter"!=e.key&&"Return"!=e.key&&"NumpadEnter"!=e.key||o()}),document.querySelectorAll(".terminal-option").forEach(n=>{n.addEventListener("click",()=>{return e=n.getAttribute("data-option"),t={add:["window add 1",1],remove:["window remove 1",1],exit:["exit",1],clear:["cls",1],help:["help",1],reset:["config reset",1],import:["config set <span class='token comment'>JSON</span>",0],export:["config get",1]},r.innerHTML=t[e][0],l.position=r.innerText.length,void(t[e][1]&&o());var e,t})}),e=>{var t;return"touchstart"==e.type||"touchmove"==e.type||"touchend"==e.type||"touchcancel"==e.type?(t=(t=void 0===e.originalEvent?e:e.originalEvent).touches[0]||t.changedTouches[0],x=t.pageX,y=t.pageY):"mousedown"!=e.type&&"mouseup"!=e.type&&"mousemove"!=e.type&&"mouseover"!=e.type&&"mouseout"!=e.type&&"mouseenter"!=e.type&&"mouseleave"!=e.type||(x=e.clientX,y=e.clientY),{x:x,y:y}}),t=(t,n)=>{let o="y"===n;var e=d(t);let r=o?c.parentElement.parentElement:document.querySelector("#terminal-fast-option"),i=o?.8*window.innerHeight:.5*window.innerWidth,l=o?.2*window.innerHeight:.1*window.innerWidth,a=r.getBoundingClientRect()[o?"height":"width"],s=e[n];e=e=>{["touchstart","touchmove","touchend","touchcancel"].includes(t.type)||e.preventDefault();e=d(e),document.body.classList.add(o?"row-resize":"col-resize"),e=a-(e[n]-s);e>l&&e<i&&(o?r.style.height=e+"px":(document.documentElement||document.querySelector(":root")).style.setProperty("--termOption",e+"px"))};window.onmousemove=e,window.ontouchmove=e,window.onmouseup=()=>u(n),window.ontouchend=()=>u(n)},u=e=>{e="y"===e;document.body.classList.remove(e?"row-resize":"col-resize"),window.onmousemove=null,window.ontouchmove=null,window.onmouseup=null,window.ontouchend=null,localStorage.setItem(e?"terminalHeight":"terminalOptWidth",e?c.parentElement.parentElement.getBoundingClientRect().height:document.querySelector("#terminal-fast-option").getBoundingClientRect().width)},a=(["mousedown","touchstart"].forEach(e=>{document.querySelector("#scroll-height.terminal").addEventListener(e,e=>t(e,"y")),document.querySelector("#scroll-width.terminal-opt").addEventListener(e,e=>t(e,"x"))}),new Terminal({terminal:{main:c,input:r,output:i,caret:n,toggleFnc:f,config:l},window:{add:w,remove:g,config:p,getLang:h},theme:{list:ThemeArr,set:e}}))};(fn=async()=>{const o=()=>{var e,t;n(),localStorage.getItem("theme")&&document.body.classList.add(localStorage.getItem("theme")),localStorage.getItem("terminalHeight")&&(t=parseFloat(localStorage.getItem("terminalHeight")),e=.8*window.innerHeight,.2*window.innerHeight<t)&&t<e&&(document.documentElement||document.querySelector(":root")).style.setProperty("--termSize",t+"px"),localStorage.getItem("terminalOptWidth")&&(e=parseFloat(localStorage.getItem("terminalOptWidth")),t=.5*window.innerWidth,.1*window.innerWidth<e)&&e<t&&(document.documentElement||document.querySelector(":root")).style.setProperty("--termOption",e+"px"),"true"==localStorage.getItem("terminal")&&f("open"),localStorage.getItem("fontSize")&&(t=parseFloat(localStorage.getItem("fontSize")),console.log(t),5<=t)&&t<=35&&(document.documentElement||document.querySelector(":root")).style.setProperty("--font-size",t+"px")};var e=location.hash.substring(1);if(0!=e.length&&"undefined"!=e&&fetch){e=await(await fetch("data:application/octet-stream;base64,"+e)).blob();let t=new FileReader;t.onload=function(){var e=Array.from(new Uint8Array(t.result));s.decompress(e,function(e,t){t&&alert("Failed to decompress data: "+t);try{var n=JSON.parse(e);"object"==typeof n&&n.forEach((e,t)=>{w(),p.windows[t].value=e,i(p.windows[t])})}catch(t){alert("Failed to writing data: "+t)}o()})},t.readAsArrayBuffer(e)}else o()})()});